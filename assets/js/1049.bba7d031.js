(window.webpackJsonp=window.webpackJsonp||[]).push([[1049],{1973:function(e,t,a){"use strict";a.r(t);var s=a(21),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"android-module-architecture"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#android-module-architecture"}},[e._v("#")]),e._v(" Android Module Architecture")]),e._v(" "),a("h2",{attrs:{id:"introduction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[e._v("#")]),e._v(" Introduction")]),e._v(" "),a("p",[e._v("The Titanium SDK is based on a modular architecture, which can be utilized to extend the SDK by building modules. The module architecture contains the following key interface components:")]),e._v(" "),a("ul",[a("li",[a("p",[a("strong",[e._v("Proxy")]),e._v(": A base class that represents the native binding between your JavaScript code and native code")])]),e._v(" "),a("li",[a("p",[a("strong",[e._v("Module")]),e._v(": A special type of Proxy that describes a specific API set or namespace")])]),e._v(" "),a("li",[a("p",[a("strong",[e._v("ViewProxy")]),e._v(": A specialized Proxy that knows how to render Views")])]),e._v(" "),a("li",[a("p",[a("strong",[e._v("View")]),e._v(": The visual representation of a UI component which Titanium can render")])])]),e._v(" "),a("p",[e._v("When building a Module, you can only have one Module class but you can have zero or more Proxies, Views and ViewProxies.")]),e._v(" "),a("p",[e._v("To return visual data between JavaScript and native code, create a View and a ViewProxy. Each View requires a View Proxy. The ViewProxy represents the model data (which is kept inside the proxy itself in case the View needs to be released) and is responsible for exposing the APIs and events that the View supports.")]),e._v(" "),a("p",[e._v("To return non-visual data between JavaScript and native code, create a Proxy. The Proxy knows how to handle any method and property, and dispatching and firing events.")]),e._v(" "),a("p",[e._v("These components require special class names and method signatures. Each components is described in further detail below.")]),e._v(" "),a("h2",{attrs:{id:"module"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#module"}},[e._v("#")]),e._v(" Module")]),e._v(" "),a("p",[e._v("A Module is a class that provides an API point with a particular ID. That ID can then be used to "),a("code",[e._v("require")]),e._v(" the module from JavaScript.")]),e._v(" "),a("p",[e._v("All modules must extend the "),a("code",[e._v("KrollModule")]),e._v(" class and have the "),a("code",[e._v("@Kroll.module")]),e._v(" annotation. All module class names and file names must have the "),a("code",[e._v("Module")]),e._v(" suffix.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('package com.example.actionbarsearch;\n\nimport org.appcelerator.kroll.KrollModule;\nimport org.appcelerator.kroll.annotations.Kroll;\n\n@Kroll.module(name="Actionbarsearch", id="com.example.actionbarsearch")\npublic class ActionbarsearchModule extends KrollModule\n{\n\n}\n')])])]),a("p",[e._v("The "),a("code",[e._v("id")]),e._v(" annotation element specifies the identifier used with "),a("code",[e._v("require")]),e._v(" to import the module. In this case, the JavaScript to require the module would look like this:")]),e._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("var")]),e._v(" actionBarSearch "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"com.example.actionbarsearch"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),a("p",[e._v("The module must have a default constructor (that is, one that takes no arguments).")]),e._v(" "),a("p",[e._v("A module can also have a parent module: "),a("code",[e._v("Titanium.UI")]),e._v(" and "),a("code",[e._v("Titanium.App")]),e._v(" are children of the Titanium module.")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("@Kroll.module")]),e._v(" annotation can also contain a "),a("code",[e._v("propertyAccessors")]),e._v(" element, which defines a set of properties exposed by the module. See "),a("a",{attrs:{href:"#properties"}},[e._v("Properties")]),e._v(" for more information.")]),e._v(" "),a("h3",{attrs:{id:"module-lifecycle-events"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#module-lifecycle-events"}},[e._v("#")]),e._v(" Module lifecycle events")]),e._v(" "),a("p",[e._v("The module provides several places for you to hook into the application's lifecycle.")]),e._v(" "),a("p",[e._v("Use the "),a("code",[e._v("@Kroll.onAppCreate")]),e._v(" annotation to declare a method to be called when the application object is created. This is optional and is only required if you have any application specific initialization, such as starting up a service that is required by the module.")]),e._v(" "),a("p",[e._v("The app create method is called during application startup. It is only called once, before your module is actually loaded.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@Kroll.onAppCreate\npublic static void onAppCreate(TiApplication app)\n{\n  Log.d(LCAT, "[MODULE LIFECYCLE EVENT] onAppCreate notification");\n}\n')])])]),a("p",[e._v("The module also provides callbacks that are invoked when the application's root activity is started, stopped, paused, or resumed.")]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("💡 Activity Lifecycle Events")]),e._v(" "),a("p",[e._v("Note that on Titanium applications, the root activity is the one that displays the splash screen. If the first UI component is a heavyweight Window (window with its own activity) or TabGroup, not all of the activity lifecycle events may fire for the root activity. Note that since Release 3.2.0, all Window objects are heavyweight and have their own activity associated with it.")]),e._v(" "),a("p",[e._v("To have the module respond to the activity lifecycle events of a specific activity of a TabGroup or Window in the JavaScript application, override the activity lifecycle callbacks of a module proxy, then associate the proxy with the Window or TabGroup whose lifecycle events you want to monitor when you create the proxy in the JavaScript application. For details, see "),a("a",{attrs:{href:"#ActivityLifecycleEvents"}},[e._v("Activity Lifecycle Events")]),e._v(" below.")])]),e._v(" "),a("h3",{attrs:{id:"get-the-current-activity"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-the-current-activity"}},[e._v("#")]),e._v(" Get the current activity")]),e._v(" "),a("p",[e._v("To get access to the current activity, first use TiApplication's getInstance() method, and then use the getCurrentActivity() method:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("TiApplication appContext = TiApplication.getInstance();\nActivity activity = appContext.getCurrentActivity();\n")])])]),a("h2",{attrs:{id:"proxy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#proxy"}},[e._v("#")]),e._v(" Proxy")]),e._v(" "),a("p",[e._v("A Proxy can expose methods, properties, and constants to JavaScript. Each of these can be a primitive type, or a proxy. Proxies also have built-in event management primarily through "),a("code",[e._v("fireEvent")]),e._v(" and "),a("code",[e._v("hasListeners")]),e._v(".")]),e._v(" "),a("p",[e._v("A proxy must extend "),a("a",{attrs:{href:"http://docs.appcelerator.com/module-apidoc/latest/android/org/appcelerator/kroll/KrollProxy.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("KrollProxy"),a("OutboundLink")],1),e._v(" and have the "),a("code",[e._v("@Kroll.proxy")]),e._v(" annotation. All proxy class names and file names must have the "),a("code",[e._v("Proxy")]),e._v(" suffix.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("package com.example.test;\n\nimport org.appcelerator.kroll.KrollProxy;\nimport org.appcelerator.kroll.annotations.Kroll;\n\n@Kroll.proxy\npublic class ExampleProxy extends KrollProxy\n{\n\n}\n")])])]),a("p",[e._v('To automatically generate a "create" method on a parent module, assign the parent module class to the '),a("code",[e._v("@Kroll.proxy creatableInModule")]),e._v(" annotation element. For example, the following code will expose the "),a("code",[e._v("createExample()")]),e._v(" method to JavaScript in the TestModule:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("package com.example.test;\n\nimport org.appcelerator.kroll.KrollProxy;\nimport org.appcelerator.kroll.annotations.Kroll;\n@Kroll.proxy(creatableInModule=TestModule.class)\npublic class ExampleProxy extends KrollProxy\n{\n\n}\n")])])]),a("h3",{attrs:{id:"methods"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#methods"}},[e._v("#")]),e._v(" Methods")]),e._v(" "),a("p",[e._v("Methods of a proxy or module are exposed with the "),a("a",{attrs:{href:"http://docs.appcelerator.com/module-apidoc/latest/android/org/appcelerator/kroll/annotations/Kroll.method.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("@Kroll.method"),a("OutboundLink")],1),e._v(" annotation. A simple example:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@Kroll.method\npublic String getMessage() {\n    return "Hello World";\n}\n')])])]),a("p",[e._v("You can specify the method parameters in one of two ways:")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("Specify parameters explicitly. In this case, the Titanium attempts to validate and convert types before calling the method.")])]),e._v(" "),a("li",[a("p",[e._v("Specify a single "),a("code",[e._v("Object[]")]),e._v(" argument. Your method must validate parameters and convert types manually at runtime.")])])]),e._v(" "),a("p",[e._v("If you specify parameters explicitly "),a("em",[e._v("and")]),e._v(" one or more parameters are optional, they must be identified using the "),a("code",[e._v("@Kroll.argument")]),e._v(" annotation:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("@Kroll.method\n public void switchView(@Kroll.argument(optional=true) boolean animate) {\n    // do something.\n }\n")])])]),a("p",[e._v("If one argument is optional, all subsequent arguments must be marked as optional as well.")]),e._v(" "),a("p",[e._v("For methods with a variable number of arguments, specify the signature as taking a single array argument, and check the number and type of the arguments at runtime.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("@Kroll.method\n public HashMap doSomething(Object[] args) {\n    // check and convert arguments\n }\n")])])]),a("p",[e._v("For information on runtime type checking and type conversions, see "),a("a",{attrs:{href:"#TypeConversions"}},[e._v("Type Conversions")]),e._v(".")]),e._v(" "),a("p",[e._v("If you want to the method name exposed to JavaScript to differ from method name in Java, use the optional "),a("code",[e._v("name")]),e._v(" element in the "),a("code",[e._v("@Kroll.method")]),e._v(" annotation to specify the JavaScript method name:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@Kroll.method(name="setTab")\npublic void setTabProxy(TiViewProxy tabProxy)\n{\n    setParent(tabProxy);\n    this.tab = tabProxy;\n}\n')])])]),a("h3",{attrs:{id:"properties"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#properties"}},[e._v("#")]),e._v(" Properties")]),e._v(" "),a("p",[e._v("Each proxy object maintains an internal dictionary of properties. Properties can be exposed to JavaScript in one of two ways:")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("Creating custom getter and setter methods. When you create a custom getter and setter methods, you can perform data validation, and take actions when the properties are set.")])]),e._v(" "),a("li",[a("p",[e._v("Specifying a list of properties in the "),a("code",[e._v("@Kroll.proxy")]),e._v(" or "),a("code",[e._v("@Kroll.module")]),e._v(" annotation with the "),a("code",[e._v("propertyAccessors")]),e._v(" element. This automatically generates getter and setter methods for each of the named properties.")])])]),e._v(" "),a("p",[e._v("When you use custom getter and setter methods, you are responsible for storing property values in whatever way you want.")]),e._v(" "),a("p",[e._v("Auto-generated property accessors store property values in the internal dictionary. The proxy class provides a set of methods for accessing the proxy's property dictionary from Java:")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("Retrieve the value of a single property using "),a("code",[e._v("getProperty()")]),e._v(".")])]),e._v(" "),a("li",[a("p",[e._v("Set an individual property using "),a("code",[e._v("setProperty()")]),e._v(".")])]),e._v(" "),a("li",[a("p",[e._v("Retrieve the entire dictionary using "),a("code",[e._v("getProperties()")]),e._v(".")])])]),e._v(" "),a("p",[e._v("In addition, you can register a "),a("em",[e._v("model listener")]),e._v(" – another Java object that receives updates whenever a value is set in the property dictionary. This pattern is commonly used for views and view proxies.")]),e._v(" "),a("p",[e._v("Using custom getter and setter methods is somewhat simpler, and is described first. Subsequent sections describe exposing properties using "),a("code",[e._v("propertyAccessors")]),e._v(", and responding to property changes using a model listener.")]),e._v(" "),a("h4",{attrs:{id:"custom-accessor-methods"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#custom-accessor-methods"}},[e._v("#")]),e._v(" Custom accessor methods")]),e._v(" "),a("p",[e._v("Properties are exposed as a pair of getter and setter methods with the "),a("code",[e._v("@Kroll.getProperty")]),e._v(" and "),a("code",[e._v("@Kroll.setProperty")]),e._v(" annotations. This method is very straightforward, but involves writing boilerplate code for each property.")]),e._v(" "),a("p",[e._v("The following example exposes a writable "),a("code",[e._v("message")]),e._v(" property to JavaScript.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('private String myMessage;\n\n@Kroll.getProperty\npublic String getMessage() {\n    return myMessage;\n}\n\n@Kroll.setProperty\npublic void setMessage(String message) {\n    Log.d(TAG, "Tried setting message to: " + message);\n  myMessage = message;\n}\n')])])]),a("p",[e._v("Note the following two points:")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("If there were no paired "),a("code",[e._v("@Kroll.setPropert")]),e._v("y method, the "),a("code",[e._v("message")]),e._v(" property would be read-only.")])]),e._v(" "),a("li",[a("p",[e._v("You are responsible for storing and retrieving the value. It can be stored in an instance variable (as in the example) or in the internal property dictionary.")])])]),e._v(" "),a("p",[e._v("In JavaScript, we can now access "),a("code",[e._v("message")]),e._v(" as a property:")]),e._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("var")]),e._v(" calc "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"module.id"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\ncalc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("message "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"hi"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"calc.message = "')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("+")]),e._v(" calc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),a("p",[e._v("The "),a("code",[e._v("@Kroll.getProperty")]),e._v(" and "),a("code",[e._v("@Kroll.setProperty")]),e._v(" annotations support an optional "),a("code",[e._v("name")]),e._v(" element, which specifies the name of the property. If name is not set, the name of the property is constr")]),e._v(" "),a("h4",{attrs:{id:"propertyaccessors-annotation-element"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#propertyaccessors-annotation-element"}},[e._v("#")]),e._v(" propertyAccessors annotation element")]),e._v(" "),a("p",[e._v("You can also define a a set of properties in your "),a("code",[e._v("@Kroll.proxy")]),e._v(" or "),a("code",[e._v("@Kroll.method")]),e._v(" annotation using the "),a("code",[e._v("propertyAccessors")]),e._v(" element, and the accessors will be automatically generated for you:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@Kroll.proxy(creatableInModule = ActionbarsearchModule.class,\n             propertyAccessors = { "hintText", "value" })\n')])])]),a("p",[e._v("In this case, the proxy has two properties, "),a("code",[e._v("hintText")]),e._v(" and "),a("code",[e._v("value")]),e._v(", each with corresponding setter and getter methods, such as "),a("code",[e._v("setHintText")]),e._v(" and "),a("code",[e._v("getValue")]),e._v(". These properties are stored in an internal dictionary. You can query properties using "),a("code",[e._v("getProperty")]),e._v(" "),a("code",[e._v("()")]),e._v(" or retrieve the entire dictionary using "),a("code",[e._v("getProperties")]),e._v(" "),a("code",[e._v("()")]),e._v(".")]),e._v(" "),a("p",[e._v("When you define properties this way, you'll usually want to add a model listener to respond to property changes. When you set a property using the generated getter and setter methods, the model listener is automatically notified.")]),e._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[e._v("⚠️ Warning")]),e._v(" "),a("p",[e._v("If you define properties using the "),a("code",[e._v("propertyAccessors")]),e._v(" element, you "),a("strong",[e._v("cannot")]),e._v(" override the accessors by defining custom accessor methods. Doing so causes module packaging to fail with a cryptic error. For each property, you must use "),a("em",[e._v("either")]),e._v(" "),a("code",[e._v("propertyAccessors")]),e._v(" or custom accessors, but not both.")])]),e._v(" "),a("h4",{attrs:{id:"handle-property-changes-using-the-model-listener"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handle-property-changes-using-the-model-listener"}},[e._v("#")]),e._v(" Handle property changes using the model listener")]),e._v(" "),a("p",[e._v("In most cases, you'll want to "),a("em",[e._v("do something")]),e._v(" when the property is set. For this reason, you can use a "),a("code",[e._v("KrollProxyListener")]),e._v(", which receives events when the proxy's properties change.")]),e._v(" "),a("p",[e._v("The model listener pattern is typically used for views, so that property changes can be delegated from the view proxy to the view object.")]),e._v(" "),a("p",[e._v("To add a listener, call the proxy's "),a("code",[e._v("setModelListener()")]),e._v(" method:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("setModelListener(delegate);\n")])])]),a("p",[e._v("In the case of view proxies, the view object is automatically added as a model listener. An instance of the "),a("code",[e._v("KrollModule")]),e._v(" class acts as its own model listener, providing a convenient mechanism for handling property changes inside a module.")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("KrollProxyListener")]),e._v(" interface defines four methods that you need to implement:")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("Method")]),e._v(" "),a("th",[e._v("Description")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[e._v("listenerAdded")]),e._v(" "),a("td",[e._v("Called when an event listener is added to the proxy.")])]),e._v(" "),a("tr",[a("td",[e._v("listenerRemoved")]),e._v(" "),a("td",[e._v("Called when an event listener is removed from the proxy.")])]),e._v(" "),a("tr",[a("td",[e._v("processProperties")]),e._v(" "),a("td",[e._v("Called when the model listener is added, with a complete set of the proxy's properties.")])]),e._v(" "),a("tr",[a("td",[e._v("propertyChanged")]),e._v(" "),a("td",[e._v("Called when one of the proxy's properties changes.")])])])]),e._v(" "),a("p",[e._v("To handle properties, you must add logic to "),a("code",[e._v("processProperties")]),e._v(" and "),a("code",[e._v("propertyChanged")]),e._v(" for each property you support. The "),a("code",[e._v("processProperties")]),e._v(" method receives a dictionary of properties:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@Override\npublic void processProperties(KrollDict props) {\n  super.processProperties(props);\n  if (props.containsKey("hintText")) {\n      searchView.setQueryHint(props.getString("hintText"));\n    }\n  if (props.containsKey("value")) {\n    searchView.setQuery(props.getString("value"), false);\n  }\n}\n')])])]),a("p",[e._v("The "),a("code",[e._v("propertyChanged")]),e._v(" method is fired whenever a property is invoked "),a("em",[e._v("after")]),e._v(" the initial call to "),a("code",[e._v("processProperties")]),e._v(".")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@Override\npublic void propertyChanged(String key, Object oldValue, Object newValue, KrollProxy proxy) {\n  if (key.equals("hintText")) {\n    searchView.setQueryHint((String) newValue);\n  } else if (key.equals("value")) {\n    searchView.setQuery((String) newValue, false);\n  }\n}\n')])])]),a("p",[e._v("You can set properties programmatically on the proxy using either "),a("code",[e._v("setProperty()")]),e._v("or "),a("code",[e._v("setPropertyAndFire()")]),e._v(". Both methods update the property dictionary and make the new property value visible to JavaScript. The "),a("code",[e._v("setPropertyAndFire()")]),e._v(" method also invokes the "),a("code",[e._v("propertyChanged")]),e._v(" callback on the model listener. In the case of a view proxy, you would typically call "),a("code",[e._v("setProperty")]),e._v(" to make a value from the native view object visible to the JavaScript layer: for example, when the user sets the text value in a text field, you want to make the value available to JavaScript_._ There is no need to fire the "),a("code",[e._v("propertyChanged")]),e._v(" callback, since the model listener itself (the view object) is generating the change.")]),e._v(" "),a("p",[e._v("You can also use custom accessor methods when using the model listener. In this case, you'd define the property getter and setter methods using the "),a("code",[e._v("@Kroll.setProperty")]),e._v(" and "),a("code",[e._v("@Kroll.getProperty")]),e._v(" annotations instead of listing the property in the "),a("code",[e._v("propertyAccessors")]),e._v(" element. You can do this if you want to validate or transform the value, or if you want to provide optional arguments in the setter. In the setter, you can then call "),a("code",[e._v("setPropertyAndFire")]),e._v(" to store the value and notify the model listener.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('@Kroll.getProperty\npublic String getMessage() {\n        return getProperty("message");\n}\n@Kroll.setProperty\npublic void setMessage(String message) {\n    // validate or transform the value\n    ...\n    // store the value and fire the callback\n    setPropertyAndFire("message", message);\n}\n')])])]),a("h3",{attrs:{id:"constants"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#constants"}},[e._v("#")]),e._v(" Constants")]),e._v(" "),a("p",[e._v("A constant is simply a static property on a "),a("code",[e._v("@Kroll.module")]),e._v(". Annotate the property with "),a("code",[e._v("@Kroll.constant")]),e._v("and declare it as both "),a("code",[e._v("static")]),e._v(" and "),a("code",[e._v("final")]),e._v(".")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("@Kroll.module\npublic class CalcModule extends KrollModule {\n    @Kroll.constant\n    public static final int ONE_HUNDRED = 100;\n}\n")])])]),a("p",[e._v("The constant can now be referred to directly from JavaScript:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("calc.ONE_HUNDRED == 100.\n")])])]),a("h3",{attrs:{id:"type-conversions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#type-conversions"}},[e._v("#")]),e._v(" Type conversions")]),e._v(" "),a("p",[e._v("Type conversions can be handled implicitly (through a method signature) or you can explicitly cast Objects to the correct types.")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("TiConvert")]),e._v(" class provides a set of helper methods for casting Objects to specific types.")]),e._v(" "),a("p",[e._v("The JavaScript, Number, String, Array, Date can be converted into the corresponding Java types, either implicitly or explicitly, as shown in the following table:")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("JavaScript Type")]),e._v(" "),a("th",[e._v("Java Type")]),e._v(" "),a("th",[e._v("Explicit Conversion")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[e._v("Number")]),e._v(" "),a("td",[e._v("int")]),e._v(" "),a("td",[a("a",{attrs:{href:"http://builds.appcelerator.com.s3.amazonaws.com/module-apidoc/2.0.0/android/org/appcelerator/platform/util/TiConvert.html#toInt(java.lang.Object)",target:"_blank",rel:"noopener noreferrer"}},[e._v("TiConvert.toInt"),a("OutboundLink")],1)])]),e._v(" "),a("tr",[a("td",[e._v("Number")]),e._v(" "),a("td",[e._v("float")]),e._v(" "),a("td",[a("a",{attrs:{href:"http://builds.appcelerator.com.s3.amazonaws.com/module-apidoc/2.0.0/android/org/appcelerator/platform/util/TiConvert.html#toFloat(java.lang.Object)",target:"_blank",rel:"noopener noreferrer"}},[e._v("TiConvert.toFloat"),a("OutboundLink")],1)])]),e._v(" "),a("tr",[a("td",[e._v("Number")]),e._v(" "),a("td",[e._v("double")]),e._v(" "),a("td",[a("a",{attrs:{href:"http://builds.appcelerator.com.s3.amazonaws.com/module-apidoc/2.0.0/android/org/appcelerator/platform/util/TiConvert.html#toDouble(java.lang.Object)",target:"_blank",rel:"noopener noreferrer"}},[e._v("TiConvert.toDouble"),a("OutboundLink")],1)])]),e._v(" "),a("tr",[a("td",[e._v("boolean")]),e._v(" "),a("td",[e._v("boolean")]),e._v(" "),a("td",[a("a",{attrs:{href:"http://builds.appcelerator.com.s3.amazonaws.com/module-apidoc/2.0.0/android/org/appcelerator/platform/util/TiConvert.html#toBoolean(java.lang.Object)",target:"_blank",rel:"noopener noreferrer"}},[e._v("TiConvert.toBoolean"),a("OutboundLink")],1)])]),e._v(" "),a("tr",[a("td",[e._v("String")]),e._v(" "),a("td",[e._v("String")]),e._v(" "),a("td",[a("a",{attrs:{href:"http://builds.appcelerator.com.s3.amazonaws.com/module-apidoc/2.0.0/android/org/appcelerator/platform/util/TiConvert.html#toString(java.lang.Object)",target:"_blank",rel:"noopener noreferrer"}},[e._v("TiConvert.toString"),a("OutboundLink")],1),e._v(" or Cast")])]),e._v(" "),a("tr",[a("td",[e._v("Object")]),e._v(" "),a("td",[e._v("HashMap<String, Object>")]),e._v(" "),a("td",[e._v("Cast")])]),e._v(" "),a("tr",[a("td",[e._v("Array")]),e._v(" "),a("td",[e._v("Object[]")]),e._v(" "),a("td",[e._v("Cast")])]),e._v(" "),a("tr",[a("td",[e._v("Date")]),e._v(" "),a("td",[e._v("Date")]),e._v(" "),a("td",[a("a",{attrs:{href:"http://builds.appcelerator.com.s3.amazonaws.com/module-apidoc/2.0.0/android/org/appcelerator/platform/util/TiConvert.html#toDate(java.lang.Object)",target:"_blank",rel:"noopener noreferrer"}},[e._v("TiConvert.toDate"),a("OutboundLink")],1),e._v(" or Cast")])]),e._v(" "),a("tr",[a("td",[e._v("Ti.Blob")]),e._v(" "),a("td",[e._v("TiBlob")]),e._v(" "),a("td",[a("a",{attrs:{href:"http://builds.appcelerator.com.s3.amazonaws.com/module-apidoc/2.0.0/android/org/appcelerator/platform/util/TiConvert.html#toBlob(java.lang.Object)",target:"_blank",rel:"noopener noreferrer"}},[e._v("TiConvert.toBlob"),a("OutboundLink")],1),e._v(" or Cast")])]),e._v(" "),a("tr",[a("td",[e._v("Ti.Filesystem.File")]),e._v(" "),a("td",[e._v("FileProxy")]),e._v(" "),a("td",[e._v("Cast")])])])]),e._v(" "),a("p",[e._v("For example, if you declare a method with int values in the signature, the JavaScript Number values passed in will be converted to Java integers implicitly:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("@Kroll.method\npublic int multiply(int a, int b)\n{\n  return a * b;\n}\n")])])]),a("p",[e._v("The same method with explicit type conversion would look like this:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("@Kroll.method\npublic int multiply(Object a, Object b)\n{\n  int aval = TiConvert.toInt(a);\n  int bval = TiConvert.toInt(b);\n  return aval * bval;\n}\n")])])]),a("h4",{attrs:{id:"files-and-blobs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#files-and-blobs"}},[e._v("#")]),e._v(" Files and blobs")]),e._v(" "),a("p",[e._v("When a JavaScript Titanium object is passed to Java, the Java method receives a reference to the associated proxy object. Among the most common of these proxy objects are the File and Blob objects.")]),e._v(" "),a("p",[e._v("The Titanium.Blob JavaScript object is represented by an instance of the "),a("code",[e._v("TiBlob")]),e._v("class. Use "),a("code",[e._v("TiBlob")]),e._v(" in method signatures where you want to accept or return a Blob.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("@Kroll.method\npublic void addBlob(TiBlob blob)\n")])])]),a("p",[e._v("To return a Blob from Java, create and return an instance of "),a("code",[e._v("TiBlob")]),e._v(". The "),a("code",[e._v("TiBlob")]),e._v(" class provides factory methods to create a "),a("code",[e._v("Blob")]),e._v(" from a byte array, File, String, or an Android Bitmap. For example, the following code returns a blob representing a bitmap:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("@Kroll.method\npublic TiBlob loadImage()\n{\n  return TiBlob.blobFromImage(myBitmap);\n}\n")])])]),a("p",[e._v("The ModDevGuide project includes sample code for retrieving a bitmap from resources.")]),e._v(" "),a("p",[e._v("A Titanium File object is passed into Java as a "),a("code",[e._v("FileProxy")]),e._v(". Use a "),a("code",[e._v("TiBaseFile")]),e._v(" object to get an instance of FileProxy given a "),a("code",[e._v("TiBaseFile")]),e._v(", and vice versa. Many APIs use the "),a("code",[e._v("TiBaseFile")]),e._v(" object internally to manipulate files, and you can easily construct a FileProxy from a TiBaseFile")]),e._v(" "),a("p",[e._v("The following example shows one way to create a "),a("code",[e._v("TiBaseFile")]),e._v(" using "),a("code",[e._v("TiFileFactory")]),e._v(", and use the new instance to construct a "),a("code",[e._v("FileProxy")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("TiBaseFile file = TiFileFactory.createTitaniumFile(new String[] { url }, false);\nFileProxy fileProxy = new FileProxy(file);\n")])])]),a("p",[e._v("You can retrieve the associated "),a("code",[e._v("TiBaseFile")]),e._v(" from a "),a("code",[e._v("FileProxy")]),e._v(" using "),a("code",[e._v("getBaseFile")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("TiBaseFile file = fileProxy.getBaseFile();\n")])])]),a("h3",{attrs:{id:"activity-lifecycle-events"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#activity-lifecycle-events"}},[e._v("#")]),e._v(" Activity lifecycle events")]),e._v(" "),a("p",[e._v("Starting with Titanium SDK 4.0.0, a proxy can respond to "),a("a",{attrs:{href:"http://developer.android.com/reference/android/app/Activity.html#ActivityLifecycle",target:"_blank",rel:"noopener noreferrer"}},[e._v("activity lifecycle events"),a("OutboundLink")],1),e._v(" by overriding the activity lifecycle callbacks, then in the JavaScript application, assign either a Window or TabGroup object to the proxy's "),a("code",[e._v("lifecycleContainer")]),e._v(" property when creating the module proxy to monitor the lifecycle events of that object to trigger the module proxy's lifecycle events.")]),e._v(" "),a("p",[e._v("First, in the module proxy, override the activity lifecycle callbacks you want to respond to, such as "),a("code",[e._v("onCreate")]),e._v(", "),a("code",[e._v("onStart")]),e._v(", "),a("code",[e._v("onRestart")]),e._v(", "),a("code",[e._v("onResume")]),e._v(", "),a("code",[e._v("onPause")]),e._v(", "),a("code",[e._v("onStop")]),e._v(" or "),a("code",[e._v("onDestroy")]),e._v(".")]),e._v(" "),a("p",[a("strong",[e._v("ExampleProxy.java")])]),e._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[e._v("@Override")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("public")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("void")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("onResume")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Activity")]),e._v(" activity"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("d")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("LCAT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"onResume called"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("loadState")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[e._v("@Override")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("public")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("void")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("onPause")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Activity")]),e._v(" activity"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("d")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("LCAT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"onPause called"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("saveState")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),a("p",[e._v("Then, in the JavaScript application, when you create the module proxy, assign its "),a("code",[e._v("lifecycleContainer")]),e._v(" property to either a Window or TabGroup object to listen for that object's lifecycle events to trigger the module proxy's activity lifecycle callbacks.")]),e._v(" "),a("p",[a("strong",[e._v("app.js")])]),e._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("var")]),e._v(" win "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" Ti"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[e._v("UI")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("createWindow")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("var")]),e._v(" foo "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'com.appc.foo'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("var")]),e._v(" fooProxy "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" foo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("createExample")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("lifecycleContainer"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" win"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\nwin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),a("h2",{attrs:{id:"view-proxy-and-view"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#view-proxy-and-view"}},[e._v("#")]),e._v(" View Proxy and View")]),e._v(" "),a("p",[e._v("To display UI elements with a module, create both a View Proxy and a View. A View Proxy is a special Proxy that is used for Views — objects which interact with the UI to draw things on the screen. The View Proxy is for exposing methods and properties of the view to JavaScript (just as a normal proxy would do), while a View acts as a model listener for the View Proxy. The view implementation is responsible for taking data from the view proxy, and applying it directly to the native "),a("a",{attrs:{href:"http://developer.android.com/reference/android/view/View.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("View"),a("OutboundLink")],1),e._v(" that it exposes.")]),e._v(" "),a("h3",{attrs:{id:"view-proxy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#view-proxy"}},[e._v("#")]),e._v(" View Proxy")]),e._v(" "),a("p",[e._v("A View Proxy must extend the "),a("code",[e._v("TiViewProxy")]),e._v(" class and have the "),a("code",[e._v("@Kroll.proxy")]),e._v("annotation. All view proxy class names and file names must have the "),a("code",[e._v("Proxy")]),e._v(" suffix. Any class that extend the "),a("code",[e._v("TiViewProxy")]),e._v(" class must also implement the "),a("code",[e._v("TiUIView createView(Activity activity)")]),e._v("method, which create and returns the associated View.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("package com.example.test;\n\nimport org.appcelerator.kroll.annotations.Kroll;\nimport org.appcelerator.titanium.proxy.TiViewProxy;\n@Kroll.proxy(creatableInModule=TestModule.class)\npublic class FooProxy extends TiViewProxy\n{\n    @Override\n    public TiUIView createView(Activity activity)\n    {\n        // Calls the View constructor\n        return new FooView(this);\n    }\n}\n")])])]),a("p",[e._v("To get a reference to the View from the View Proxy, use the "),a("code",[e._v("view")]),e._v(" variable:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("FooView fooView = (FooView)view;\n")])])]),a("h3",{attrs:{id:"view"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#view"}},[e._v("#")]),e._v(" View")]),e._v(" "),a("p",[e._v("A View must extend the "),a("code",[e._v("TiUIView")]),e._v(" class. All view class names and file names must have the "),a("code",[e._v("View")]),e._v(" suffix. Any class that extends the "),a("code",[e._v("TiUIView")]),e._v(" class must implement a constructor and call "),a("code",[e._v("setNativeView")]),e._v(" with an instance of a native Android "),a("a",{attrs:{href:"http://developer.android.com/reference/android/view/View.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("View"),a("OutboundLink")],1),e._v(" either in the constructor or in "),a("code",[e._v("processProperties.")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("package com.example.test;\n\nimport org.appcelerator.titanium.view.TiUIView;\nimport org.appcelerator.titanium.view.TiCompositeLayout;\nimport org.appcelerator.titanium.view.TiCompositeLayout.LayoutArrangement;\nimport org.appcelerator.titanium.proxy.TiViewProxy;\nimport android.view.View;\n\nprivate class ExampleView extends TiUIView\n{\n    public ExampleView(TiViewProxy proxy) {\n        super(proxy);\n        setNativeView(new TiCompositeLayout(proxy.getActivity(), LayoutArrangement.DEFAULT));\n    }\n}\n")])])]),a("h3",{attrs:{id:"view-property-and-methods"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#view-property-and-methods"}},[e._v("#")]),e._v(" View Property and methods")]),e._v(" "),a("p",[e._v("To set a property or invoke a method on a View, the View Proxy acts as an intermediary between the JavaScript and View. The View Proxy exposes APIs to the JavaScript, then invokes APIs on the View. However, the application must be running on the UI thread. The code below checks to see if the application is running on the UI thread. If it is not, it sends a blocking message until it is back on the UI thread.")]),e._v(" "),a("p",[a("strong",[e._v("FooProxy.java")])]),e._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("private")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("static")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("final")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("int")]),e._v(" MSG_SET_COLOR "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("70000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[e._v("@Kroll.setProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("retain"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("public")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("void")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("setProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("final")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("String")]),e._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Get the view object from the proxy and set the property")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("if")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("view "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Check to see if we are on the UI thread")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("if")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("!")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("TiApplication")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("isUIThread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// If not,")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("TiMessenger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("sendBlockingMainMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("new")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("TiMessenger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("getMainMessenger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("getLooper")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("new")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Handler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("public")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("boolean")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("handleMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("Message")]),e._v(" msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("switch")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("what"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n                        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("case")]),e._v(" MSG_SET_PROPERTY"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n                            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("AsyncResult")]),e._v(" result "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("AsyncResult")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n                            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("FooView")]),e._v(" fooView "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("FooView")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("view"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n                            fooView"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("setProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n                            result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("setResult")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n                            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n                        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("obtainMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("MSG_SET_PROPERTY"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("else")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// If we are on the UI thread")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("FooView")]),e._v(" fooView "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("FooView")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("view"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n            fooView"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("setProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Updates the property on the Proxy object")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("setProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"property"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);